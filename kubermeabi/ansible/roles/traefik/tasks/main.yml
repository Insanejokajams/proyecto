---
- name: Create namespace for Traefik
  kubernetes.core.k8s:
    api_version: v1
    kind: Namespace
    name: traefik
    state: present

- name: Add Traefik Helm repo
  kubernetes.core.helm_repository:
    name: traefik
    repo_url: https://traefik.github.io/charts

- name: Install Traefik via Helm
  kubernetes.core.helm:
    name: traefik
    chart_ref: traefik/traefik
    chart_version: "26.0.0"
    release_namespace: traefik
    values_files:
      - "{{ role_path }}/templates/values.yaml.j2"
    state: present

